<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper 
    PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
    "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="memberAgreement">
	<parameterMap id="memberAgreement" type="com.sw.plugins.commission.contract.entity.MemberAgreement"/>
	
	<!-- 理财师机构结果集 -->
	<resultMap id="memberAgreementResult" type="com.sw.plugins.commission.contract.entity.MemberAgreement">
		<id property="id" column="ID" javaType="java.lang.Long"/>
		<result property="orgID" column="OrgID" />
		<result property="agreementTemplateID" column="AgreementTemplateID" />
		<result property="status" column="Status" />
		<result property="stopTime" column="StopTime" />
	</resultMap>

	<!-- 更新网签关系表里的该机构下的关系为已失效-->
	<update id="update" parameterMap="memberAgreement">
	update MC_MemberAgreement
		<set>
			<trim prefixOverrides=",">
				<if test="status!=null and status!=''">,status=#{status}</if>
				,stopTime=now()
			</trim>
		</set>
	where OrgID = ${orgID} 
	</update> 
	<delete id="delete" parameterMap="memberAgreement">
		delete from MC_MemberAgreement
		<where>
			agreementTemplateID=#{agreementTemplateID} 
		</where>		
	</delete>
</mapper>
